using Autofac;
using DayEasy.Framework;
using DayEasy.Services;

namespace DayEasy.Open.Test
{
    public abstract class OpenTestBase
    {
        protected DayEasyBootstrap Bootstrap { get; private set; }
        protected IContainer Container { get; private set; }
        protected OpenTestBase()
        {
            Bootstrap = DayEasyBootstrap.Instance;
            Bootstrap.BuilderHandler += build =>
            {
                build.RegisterGeneric(typeof(DayEasyRepository<>)).As(typeof(IDayEasyRepository<>));
                build.RegisterGeneric(typeof(DayEasyRepository<,>)).As(typeof(IDayEasyRepository<,>));
                build.RegisterGeneric(typeof(Version3Repository<>)).As(typeof(IVersion3Repository<>));
                build.RegisterGeneric(typeof(Version3Repository<,>)).As(typeof(IVersion3Repository<,>));
            };
            Bootstrap.Initialize();
            Container = Bootstrap.Container;
        }
    }
}
