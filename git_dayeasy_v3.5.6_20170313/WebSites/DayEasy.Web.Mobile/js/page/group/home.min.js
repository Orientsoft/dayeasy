!function(e,o){window.flag=0,o.progress.start();var s,a,d,t=1,n=(o.getLogger("group-home"),e(".d-group-list")),i=e(".d-group-no-class"),r=e(".group-soso"),l=e(".d-soso-one"),c=e(".d-group-no-soso"),p=e(".d-group-soso-list"),u=e(".dy-form-field"),g=!0,f=e(".select-main"),h=e(".select-option li"),m=e(".select-option"),v=e(".d-group-name");s=function(){e.dAjax({method:"group_groups",type:0,loadMessage:!0},function(e){return e.status&&0!=e.count?void a(e.data):(n.addClass("hide"),i.removeClass("hide"),!1)})},a=function(e){var o;o=n.find("dl");for(var s=0;s<e.length;s++){var a=e[s],d=o.eq(a.type);d.removeClass("hide");var t=template("groupTemp",a);d.append(t)}},s(),o.progress.done(),r.on("click",function(){g?(e(this).find(".dy-icon-search").addClass("dy-icon-left"),n.addClass("hide"),l.removeClass("hide"),v.text("圈子搜索"),i.addClass("hide"),u.val("").focus(),t=1,g=!1):(e(this).find(".dy-icon-search").removeClass("dy-icon-left"),v.text("我的圈子"),n.removeClass("hide"),console.log(n.find("dd").length),0==n.find("dd").length&&i.removeClass("hide"),l.addClass("hide"),p.empty().addClass("hide"),c.addClass("hide"),e(window).unbind("scroll"),g=!0)}),l.on("click",".btn-soso",function(){var s=e(this),a=s.parents(l),n=a.find(".dy-form-field").val();0==window.flag&&(window.flag=1,o.progress.start(),d(n,t))}).on("change",u,function(){window.flag=0,t=1}),d=function(s,a){var d=f.find("span").data("type");e.dAjax({method:"group_search",keyword:s,type:d,page:a},function(s){if(c.addClass("hide"),!s.status||0==s.count)return p.empty(),c.removeClass("hide"),o.progress.done(),!1;if(0==s.data)return p.append('<div class="dy-load-bata">没有相关圈子了</div>'),e(window).unbind("scroll"),!1;var a=s.data,d=function(e){for(var s="<ul>",a=0;a<e.length;a++)s+="<li>",s+='<img src="'+e[a].logo+'" width="80" height="80" alt="'+e[a].groupSummary+'">',s+='<span class="group-name">'+e[a].name+"</span>",s+='<div class="group-count am-text-truncate">'+e[a].code+"</div>",s+='<div class="group-count group-member am-text-truncate ">'+(e[a].owner||"")+"</div>",s+='<div class="d-message-count"><a href="/page/group/apply.html?groupId='+e[a].id+"&logo="+e[a].logo+"&name="+e[a].name+"&code="+e[a].code+"&count="+(e[a].owner||"")+"&type="+(e[a].groupSummary||"")+'">申请加入</a></div>',s+="</li>";s+="</ul>",p.empty().removeClass("hide").append(s),o.progress.done()};d(a)})},e(window).scroll(function(){if(!p.hasClass("hide")){var s=e(this).scrollTop(),a=e(document).height(),n=e(this).height();if(s+n==a){var i=u.val();o.progress.start(),t+=1,d(i,t),o.progress.done()}}}),e("body").on("click",".select-wrap",function(e){e.preventDefault(),g?(m.stop(!0,!0).slideDown(),g=!1):(m.stop(!0,!0).slideUp(),g=!0)}),h.click(function(){var o=e(this),s=o.text();f.find("span").data("type",o.data("type")),f.find("span").text(s),m.slideUp(10),u.focus()}),e.dAjax({method:"user_children"},function(s){console.log(s.data),""==s.data&&e("body").on("click",".d-message-count",function(e){return e.preventDefault(),o.msg("请用电脑登录绑定学生后，再加圈"),!1})},!0)}(jQuery,SINGER);