!function(t,e){function i(){d=t(document).scrollTop();var e=t(this),i=e.parents("li"),a=i.find(".base-display").text(),s=i.find(".item-pop-html").html();t(".wrap-group").hide();var o=t(".wrap-pop");o.show(),o.find(".d-pop-name").text(a),o.find(".information-contents").html(s)}function a(){event.preventDefault(),t(document).scrollTop(d);var e=t(this),i=e.parents(".wrap-pop");i.hide(),t(".wrap-group").show()}var s,o,l=e.uri(),n=e.getLogger("group-item");e.progress.start();var r,d=0,p=0,c=15,g=t(".group-list").find(".group-list-ul"),m=g.width()-72;if(t(".d-group-name").html(l.name),document.title=l.name+" - "+document.title,!l.id||32!=l.id.length)return location.href="/page/group/home.html",!1;var h=function(t){return t=t.replace(/<\/?[^>]*>/g,""),t=t.replace(/[ | ]*\n/g,"\n"),t=t.replace(/ /gi,"")};o=function(i){t.dAjax({method:"group_isMember",id:l.id},function(t){return t.status&&0==t.data?void(i&&i.call(this)):(e.msg("你还不是该圈子的成员！",1200,function(){location.href="/page/group/home.html"}),!1)})},s=function(i,a,s){t.dAjax({method:"group_dynamics",groupId:l.id,type:i,page:a,size:s},function(i){return n.info(i),i.status&&0!=i.data.totalCount?(e.progress.start(),void r(i.data)):(t(".dy-load-bata").show(),t(window).unbind("scroll"),e.progress.done(),!1)})},o(function(){s(-1,p,c)}),r=function(i){for(var a=0;a<i.newsDetails.length;a++){var s,o=i.newsDetails[a],n=i.users[o.userId]||0,r=n?n.avatar:"/image/default/user_s160x160.png",d=n?n.name:"";s='<li data-type="'+o.dynamicType+'" data-batch="'+o.batch+'" data-paperid="'+o.paperId+'">',s+='<div class="am-g">',s+='<div class="f-cb">',s+='<div class="box-sm-6 am-text-left user-img">',s+='<img src="'+r+'" width="20" height="20" alt="'+d+'"/>',s+="<span>"+d+"</span>",s+="</div>",s+='<div class="box-sm-6 am-text-right d-time">'+o.time+"</div>",s+="</div>",s+='<div class="box-sm-12 f-cb">',0==o.dynamicType&&(s+='<strong class="task-display base-display">作业</strong>',s+='<a class="group-list-title" style="width:'+m+'px"  data-title="'+o.title+'" href="/page/work/answer-paper.html?batch='+o.batch+"&paperId="+o.paperId+"&name="+o.title+"&groupId="+l.id+"&group="+l.name+'">'+(o.title?o.title:"")+"</a>"),1==o.dynamicType&&(s+='<strong class="examination-display base-display">考试</strong>',s+='<a class="group-list-title" style="width:'+m+'px" data-title="'+o.title+'" href="/page/work/answer-paper.html?batch='+o.batch+"&paperId="+o.paperId+"&name="+o.title+"&groupId="+l.id+"&group="+l.name+'">'+(o.title?o.title:"")+"</a>"),2==o.dynamicType&&(s+='<strong class="notice-display base-display">通知</strong>',s+='<a class="group-list-title item-pop" style="width:'+m+'px"  href="javascript:void(0);">'+h(o.message?o.message:"")+"</a>",s+='<div class="hide item-pop-html">'+(o.message?o.message:"")+"</div>"),4==o.dynamicType&&(s+='<strong class="praise-display base-display">表扬</strong>',s+='<a class="group-list-title item-pop" style="width:'+m+'px"  href="javascript:void(0);">'+h(o.message?o.message:"")+"</a>",s+='<div class="hide item-pop-html">'+(o.message?o.message:"")+"</div>"),6==o.dynamicType&&(s+='<strong class="achievement-display base-display">成绩通知</strong>',s+='<a class="group-list-title" style="width:'+m+'px" data-title="'+o.title+'" href="/page/group/notice-analysis.html?examId='+o.examId+"&id="+o.id+"&name="+o.title+'">'+(o.title?o.title:"")+"</a>"),s+="</div>",s+="</div>",s+="</li>",g.append(s)}t(".dy-loading").hide(),e.progress.done()},t(window).scroll(function(){var e=t(this).scrollTop(),i=t(document).height(),a=t(this).height();e+a==i&&(p+=1,s(-1,p,c))}),t("body").on("click",".item-pop",i).on("click",".pop-back",a),g.on("click","li",function(e){e.preventDefault();var i=t(this).find(".group-list-title").attr("href");window.location.href=i}),t(window).scroll(function(){var e=t("#f-scroll"),i=2*t(window).height();t(this).scrollTop()>i?e.addClass("on").css("position","fixed"):e.removeClass("on").css("position","relative")}),t(window).resize(function(){var t=g.find(".group-list-title");m=g.width()-52,t.css("width",m)})}(jQuery,SINGER);