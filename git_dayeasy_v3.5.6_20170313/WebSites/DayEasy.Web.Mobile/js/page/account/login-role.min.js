!function(e,s){function n(s,n){s.parents(".d-input").removeClass("d-input-err").find(".d-err-tips").remove(),s.parents(".d-input").addClass("d-input-err").append('<span class="d-err-tips">'+n+"</span>"),s.focus(function(){e(this).parents(".d-input").removeClass("d-input-err").find(".d-err-tips").remove()})}function t(e){return-1!==e.indexOf("帐号已被使用")&&n(v,"帐号已被使用"),-1!==e.indexOf("帐号已注册")?(n(v,"帐号已注册！"),!1):(-1!==e.indexOf("手机号不正确")&&n(v,"手机号不正确"),-1!==e.indexOf("密码")&&n(m,"最少6位密码"),-1!==e.indexOf("短信验证码验证失败")&&n(x,"验证码验证失败"),void(-1!==e.indexOf("签名无效")&&n(x,"验证码错误")))}function i(e){return/^1[3|4|5|7|8]\d{9}$/.test(e)||t("手机号不正确"),!1}function a(e){return/^[^\s]{6,20}$/.test(e)||t("最少6位密码"),!1}var d,o=e(".role-checkbox"),r=o.find(".hang-base"),l=e(".subject"),c=e("d-base-header"),p=e("#textid"),u=c.find(".hp-right"),f=e("#NextStep"),h=e(".notes-login"),b=0,v=e("#mobile"),m=e("#password"),x=e("#vcode");r.not("#selected").on("click",function(){e(this).addClass("on").siblings(".hang-base").removeClass("on"),f.find("span").removeClass("disabled")}),l.on("click","li",function(){var s=e(this);s.addClass("on").siblings().removeClass("on");var n=s.find("span").text();r.find(".b-text").text(n),r.find(".b-text").text(n).parents(".hang-base").addClass("on").siblings().removeClass("on"),f.find("span").removeClass("disabled"),e(".closure-box").remove(),e.panelslider.close()}),f.on("click",".d-btn",function(){o.find(".on").length?(o.hide(),u.hide(),h.show(),p.text("注册账号").end().find(".hp-text").show(),f.find(".d-err-tips").remove()):(f.find(".d-err-tips").remove(),s.msg("请选择用户身份"))}),e(".hp-text").click(function(){e(this).hide(),h.hide(),p.text("注册身份"),o.show(),u.css("display","inline-block")}),e("#btnSendCode").on("click",function(){var n=e(this);e.dAjax({method:"message_sendSmsCode",mobile:v.val(),isEncrypt:!1},function(e){return console.log(e),e.status?void s.Reacquisition(v,n):(t(e.message),!1)},!0)}),e("#perForm").on("keyup","#mobile,#password,#vcode",function(s){s.preventDefault();var n=v.val(),t=m.val(),i=x.val();""!=n&&""!=t&&""!=i?e("#perSubmit").removeClass("disabled"):e("#perSubmit").addClass("disabled")}),e("#perSubmit").click(function(s){if(e(this).hasClass("disabled"))return!1;var n=v.val(),o=m.val(),r=x.val();return i(n),a(o),e(".hang-base").each(function(){var s=e(this);if(s.hasClass("on")){if(d=s.find(".role").data("role"),4==d)return e("#right-panel").find("li").each(function(){e(this).hasClass("on")&&(b=e(this).find("span").data("subject"))}),!1;b=0}}),e.dAjax({method:"user_regist",mobile:n,password:o,vcode:r,role:d,subjectId:b,isEncrypt:!1},function(s){s.status?(e.setToken(s.data.token),window.location.href="/page/account/signup-success.html"):t(s.message)},"json"),!1}),e("#perForm").submit(function(){}),e(".d-btn-pwd").bind("click",function(){var s=e(this),n=e("#password");"password"===n.attr("type")?(n.attr("type","text"),s.addClass("d-btn-on")):(n.attr("type","password"),s.removeClass("d-btn-on"))})}(jQuery,SINGER);