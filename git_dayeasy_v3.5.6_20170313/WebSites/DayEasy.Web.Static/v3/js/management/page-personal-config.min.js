var indexConfig=function(e,t){var a={data:{},seed:1e3,maxSectionLen:6,maxTabLen:4,sources:[],sourceLen:4,getSeed:function(e){return e=e||"S",e+ ++a.seed},init:function(){e.post("/operate/personal-config/data",{},function(t){a.data=t.data,a.data.teachers=a.data.teachers||[],a.data.students=a.data.students||[],e(".teachers-num").html(a.data.teachers.length),e(".students-num").html(a.data.students.length)})},checkAdver:function(n){var s,c=n.parent().data("type"),r=[],u=0;switch(c){case"teachers":r=a.data.teachers,a.sourceLen=6,s=e(".teachers-num");break;case"students":r=a.data.students,a.sourceLen=6,s=e(".students-num");break;default:return t.msg("类型无效"),!1}if(a.sources=[],r&&r.length)for(u=0;u<r.length;u++)a.sources.push({id:r[u],name:""});e.get("/operate/advert?partial=1",{},function(e){t.dialog({title:"选择图文广告",content:e,okValue:"确定",cancelValue:"取消",ok:function(){if(r.splice(0,r.length),a.sources&&a.sources.length)for(u=0;u<a.sources.length;u++)r.push(a.sources[u].id);s.text(r.length)},cancel:function(){},width:800,height:410}).showModal()})},getItemById:function(e,t){if(!e||!e.length||!t)return 0;for(var a=0;a<e.length;a++)if(t==e[a].id)return e[a]},save:function(n){return a.data.teachers&&a.data.teachers.length>6||a.data.students&&a.data.students.length>6?(n&&n.call(null),void t.msg("教师和学生模块需要3-9条图文数据")):void e.post("/operate/personal-config/save",{data:t.json(a.data)},function(e){return n&&n.call(null),e.status?void t.msg("保存成功"):void t.alert(e.message)})}};return a}(jQuery,SINGER);!function(e,t,a){a.init(),e(".ic-box").delegate(".ic-check","click",function(){var t=e(this);return t.data("group")?void a.checkGroup(t):void a.checkAdver(t)}),e("#btnSave").bind("click",function(){var t=e(this);t.disabled("稍后.."),a.save(function(){t.unDisabled()})})}(jQuery,SINGER,indexConfig);