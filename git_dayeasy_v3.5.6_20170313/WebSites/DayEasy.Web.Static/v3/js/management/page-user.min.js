!function(t,e){t("#role").bind("change",function(){t("#searchForm").submit()}),t(".b-user-active").bind("click",function(){var a=t(this).parents("tr").data("uid");return t.get("/user/active/"+a,{},function(t){e.dialog({title:"用户活跃信息",content:t}).showModal()}),!1}),t(".b-certificate").bind("click",function(){var a=t(this).parents("tr"),n=a.data("uid"),i=function(){return t.post("/user/certificate",{id:n},function(t){return t.status?void e.msg("认证成功！",2e3,function(){location.reload(!0)}):(e.alert(t.message),!1)}),!1};e.confirm("确定认证该用户？",function(){i()})}),t(".a-delete").click(function(){var a=t(this),n=a.data("status"),i=a.parents("tr").data("uid"),r=4==n?"删除":"还原";t.Dayez.confirm(e.format("确定要{0}该用户？",r),function(){t.post("/user/delete",{userId:i},function(t){t.status?e.msg(r+"成功！",2e3,function(){window.location.reload(!0)}):e.alert(t.message)})},function(){})}),t(".a-reset").click(function(){var a=t(this).parents("tr").data("uid");t.Dayez.confirm("您确定要重置该用户密码?",function(){t.post("/user/reset",{userId:a},function(t){t.status?e.msg("重置成功！",2e3):e.alert(t.message)})},function(){})}),t(".a-edit").click(function(){var a=t(this).parents("tr"),n=a.data("uid"),i=a.data("rname"),r=template("edit-template",{name:i}),o=e.dialog({title:"编辑用户资料",content:r,okValue:"确定",cancelValue:"取消",ok:function(){return i=t("#txtRealName").val(),i&&i.length?(t.post("/user/edit",{userId:n,name:i},function(t){return t.status?(a.data("rname",i).find("td").eq(1).html(i),void o.close().remove()):void e.msg(t.message)}),!1):(e.msg("真实姓名不能为空"),!1)},cancel:function(){}});o.showModal()});var a;window.importCallback=function(t){t.status?(e.msg("导入成功！"),a&&a.close().remove()):e.alert(t.message)},t(".b-import-num").bind("click",function(){var n,i;n=function(t){t.submit()},i=t('<div class="d-import-area">').css({width:400}),i.append('<iframe name="importTarget" class="hide" frameborder="0" height="0" width="0">');var r=t('<form action="/user/import-num?callback=parent.importCallback" method="POST" target="importTarget" enctype="multipart/form-data">');r.append('<div class="text-gray" style="margin-bottom: 15px">请输入学生学号信息，格式：<em>得一号,学号</em>，一行一个。</div>'),r.append('<textarea class="form-control" name="numbers" style="height:200px;margin-bottom:15px"></textarea>'),r.append('<input name="numberFile" type="file"/>'),i.append(r),a=e.dialog({title:"导入学生学号",content:i,okValue:"确认导入",ok:function(){var e=t(this.node).find(".d-import-area form");return n(e),!1}}),a.showModal()}),t(document).delegate(".j-release","click",function(){var a=t(this),n=a.data("uid");a.disableField("稍后.."),e.confirm('确认要释放该用户？<br /><b class="text-danger">释放后，将重置该用户的邮箱、手机以及第三方信息，且用户将不能登录</b>',function(){t.post("/user/release-user",{userId:n},function(t){return t.status?(e.msg("释放成功"),a.remove(),!1):(e.alert(t.message),void a.undisableFieldset())})},function(){a.undisableFieldset()})})}(jQuery,SINGER);