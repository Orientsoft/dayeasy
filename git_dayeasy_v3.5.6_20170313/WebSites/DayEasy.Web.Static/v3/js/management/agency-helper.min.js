!function(e,a){e.fn.extend({agency:function(i){var t=e(this);if(i=a.mix({item:e(".dy-agency-wrap"),list:e(".dy-agencies"),init:void 0,add:void 0,remove:void 0,singe:!1},i||{}),0==t.length||0==i.item.length||0==i.list.length)return!1;i.singe=t.data("singe");var s=i.item.find("#agencyId"),n=s.val(),d="";n&&e.post("/system/agency",{id:n},function(e){if(e.status){i.item.removeClass("hide");var s=a.format('<em class="stage{stageCode}">{stage}</em>{name}<small>{area}</small>',e.data);i.item.find(".dy-agency-item").html(s).append('<i title="删除" class="fa fa-times"></i>'),i.singe&&t.hide(),i.init&&a.isFunction(i.init)&&i.init.call(this,e.data)}}),t.bind("keyup.agency",function(){var t=a.trim(e(this).val());return n||d==t?!1:(d=t,d&&a.trim(d)?void e.post("/system/agencies",{keyword:encodeURIComponent(d)},function(t){if(i.list.empty(),t.status){for(var s=0;s<t.data.length;s++){var n=t.data[s],d=e(a.format('<p class="dy-agency-item"><em class="stage{stageCode}">{stage}</em>{name}<small>{area}</small></p>',n));d.data("agency",n),i.list.append(d)}i.list.removeClass("hide")}else i.list.addClass("hide")}):(i.list.empty(),i.list.addClass("hide"),!1))}),i.list.delegate("p","click",function(){var n=e(this),d=n.data("agency");s.val(d.id),t.val(""),i.list.empty().addClass("hide"),i.singe&&t.hide(),i.add&&a.isFunction(i.add)&&i.add.call(this,d)}).delegate("p","mouseenter",function(){e(this).addClass("hover")}).delegate("p","mouseleave",function(){e(this).removeClass("hover")}),i.item.delegate("i","click",function(){s.val(""),i.item.addClass("hide"),i.item.find(".dy-agency-item").html(""),i.singe&&t.show().focus(),d="",n="",i.remove&&a.isFunction(i.remove)&&i.remove.call(this)})}}),e(".agency-input").agency()}(jQuery,SINGER);