!function(t,a){var e,n,r,d;a.getLogger("exam");e=function(e){var n,r,d,l=e.data("details");if(d=e.find("td").eq(0).find("a").html(),n=function(){var e=t('<table class="table table-bordered"><colgroup><col style="width:4em"/><col style="width:15em"/><col style="width:6em"/><col/></colgroup></table>');e.append("<thead><tr><th>科目</th><th>试卷名称</th><th>发起人</th><th>班级详情</th></tr></thead>");var n=t("<tbody>");for(r=0;r<l.length;r++){for(var i=l[r],o="",s=0;s<i.jointClasses.length;s++)o+=a.format('<span class="dy-class-item">{className}<small>({studentCount})</small></span>',i.jointClasses[s]);n.append(a.format("<tr><td>{0}</td><td>{1}</td><td>{2}</td><td>{3}</td></tr>",i.subject,i.paperTitle,i.creator.name,o))}e.append(n),a.dialog({title:d,content:e}).showModal()},l&&l.length)n();else{var i=e.data("eid");t.get("/exam/details",{id:i},function(t){l=t.data||[],e.data("details",l),n()})}},n=function(e){var n=e.find("td").eq(0).find("a").html();a.confirm(a.format('确认推送"<strong>{0}</strong>"？<label class="text-danger">推送后将不能取消！</label>',n),function(){return t.post("/exam/send",{id:e.data("eid")},function(t){t.status?a.alert("推送成功！",function(){location.reload(!0)}):a.alert(t.message)}),!1})},r=function(e){var n=e.find("td").eq(0).find("a").html();a.confirm(a.format('确认删除"<strong>{0}</strong>"？<label class="text-danger">删除后将不能还原！</label>',n),function(){return t.post("/exam/delete",{id:e.data("eid")},function(t){t.status?a.alert("删除成功！",function(){location.reload(!0)}):a.alert(t.message)}),!1})},d=function(e){var n=t("#exportForm");if(n&&n.length)n.empty();else{var r=t("body");n=t('<form method="post" target="_blank" class="hide">'),r.append(n)}n.attr("action",a.sites.apps+"/ea/ranking-download"),n.append('<input name="examId" value="'+e+'" />'),n.submit()},t(".b-details").bind("click",function(){var a=t(this).parents("tr");return e(a),!1}),t(".b-send").bind("click",function(){var a=t(this).parents("tr");return n(a),!1}),t(".b-delete").bind("click",function(){var a=t(this).parents("tr");return r(a),!1}),t(".b-export").bind("click",function(){var a=t(this).parents("tr");return d(a.data("eid")),!1})}(jQuery,SINGER);