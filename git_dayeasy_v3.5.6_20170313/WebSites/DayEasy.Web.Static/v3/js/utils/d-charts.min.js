!function(a,t){var e=function(a){if(100>a)return 5>=a?5:10>=a?10:(a%10!=0&&(a+=10-a%10),a);var t=a%100;return t>0&&(a+=t>50?100-t:20>t?20-t:50-t),a};a.fn.extend({chart:function(t){var n,i,s=a(this),h=a('<div class="d-chart">'),c=0,p=0,v=0;n=t.type&&"percent"==t.type?a.extend({},d,t||{}):a.extend({},r,t||{}),i="v"==n.direct,i?n.chartWidth?n.chartWidth:n.chartWidth=Math.min((n.width-93)/n.data.length,70):n.chartWidth?n.chartWidth:n.chartWidth=Math.min(n.height/n.data.length,70),s.css({width:n.width}),h.css({height:n.height}),a.each(n.data,function(t,e){e.value=parseFloat(e.value),e.value>c&&(c=e.value),p+=e.value;var r=a('<div class="d-chart-item">');r.append("<span>"+n.labelFormat(e)+"</span>"),r.append('<div class="d-chart-box">'),r.append('<div class="d-chart-label">'+n.xFormat(e)+"</div>"),r.data("value",e.value),i?r.css({width:n.chartWidth}):r.css({height:n.chartWidth+"px"}),h.append(r)}),c=n.max>0?n.max:e(c);var o=6;(100>c||c%50==0||c%6!=0)&&(o=5),i?(h.addClass("d-chart-v"),v=n.height/c):(h.addClass("d-chart-h"),v=(n.width-90)/c);for(var l=a('<div class="d-chart-steps">'),u=0;o>u;u++){var m=a('<div class="d-chart-step">'),f=parseFloat(((u+1)*(c/o)).toFixed(2));i?m.css({bottom:f*v-3}).append("<span>"+n.yFormat(f)+"</span>"):m.css({left:f*v-3}).append("<span>"+n.yFormat(f)+"</span>"),l.append(m)}if(n.showAverage&&n.average>0){"undefined"==typeof n.average&&(n.average=(p/n.data.length).toFixed(2));var g=a('<div class="d-chart-step d-average">');i?g.css({bottom:n.average*v-3}).append("<span>"+n.averageFormat(n.average)+"</span>"):g.css({left:n.average*v}).append("<span>"+n.averageFormat(n.average)+"</span>")}l.append(g),h.append(l);var x=a('<div class="d-chart-wrap">');x.append(h),n.xTitle&&x.append('<div class="d-chart-x">'+n.xTitle+"</div>"),n.yTitle&&x.append('<div class="d-chart-y">'+n.yTitle+"</div>"),s.append(x),s.find(".d-chart-item").each(function(t,e){var r,d,i=a(e),s=i.data("value");if(n.showAverage){r=(s-n.average).toFixed(2),d=a('<div class="d-chart-diff">'+n.tipFormat(r)+"</div>"),r>0&&d.addClass("d-diff-success");var h=(n.chartWidth-60)/2;d.css({left:h}),s<n.average&&i.addClass("d-chart-danger")}var c=v*s;"v"==n.direct?(i.find("span").animate({bottom:c+5},n.speed),d&&d.css({bottom:c+5}),i.find(".d-chart-box").animate({height:Math.max(c-3,1)},n.speed)):(i.find("span").animate({left:c+5},n.speed),d&&d.css({left:c+5}),i.find(".d-chart-box").animate({width:Math.max(c,1)},n.speed)),n.showAverage&&i.append(d)})}});var r={data:[],direct:"v",xTitle:"x",yTitle:"y",showAverage:!0,average:t,chartWidth:70,speed:1500,width:300,height:200,max:0,xFormat:function(a){return a.name},yFormat:function(a){return a},labelFormat:function(a){return a.value},averageFormat:function(a){return"平均分<em>"+a+"</em>"},tipFormat:function(a){return(a>0?"+"+a:a)+"分"}},d=a.extend({},r,{showAverage:!1,max:100,yFormat:function(a){return a+"%"},labelFormat:function(a){return a.value+"%"},tipFormat:function(a){return(a>0?"+"+a:a)+"%"},averageFormat:function(a){return"平均 "+a+"%"}});a.extend({nearMax:e})}(jQuery);