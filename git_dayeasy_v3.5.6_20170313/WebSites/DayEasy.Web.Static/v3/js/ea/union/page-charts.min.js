!function(e,a){var t,n,i,s,l,o=e(".dy-main").data("batch"),r=0,c=1,d=a.chartApi,u=e(".html-main"),m=e(".html-side"),v={};t=function(){var e,a="",t="";r?(e=d.subjectRanks(r),a=template("subjectRanksTpl",e)):(e=d.ranks(),a=template("ranksTpl",e),t=template("sideCountTpl",e.count)),u.html(a),m.html(t),u.tableScroll()},n=function(){var a,t,n,i=d.averageCompare(r),s=template("averageTpl",{isAb:i.isAb});u.html(s),t=u.find(".container02"),n=u.find(".js-choice-li"),a=function(e){t.empty().chart({type:"score",data:e.list,showAverage:!0,max:e.max,direct:"v",average:e.average,width:956,height:300,xTitle:"学校",chartWidth:100,yTitle:"分数",xFormat:function(e){return e.name}})},n.find("li").bind("click",function(){var n=e(this),s=n.data("source");return n.hasClass("on")?!1:(n.addClass("on").siblings().removeClass("on"),void(i.hasOwnProperty(s)?a(i[s]):t.html('<div class="dy-nothing">报表数据异常</div>')))}).eq(0).click()},i=function(){v.hasOwnProperty(r)||(v[r]={});var a,t,n,i=d.focusRateAnalysis(r,v[r]),s=template("focusRateTpl",v[r]);u.html(s),t=u.find(".container03"),n=u.find(".js-choice-li"),a=function(e){console.log(e),t.empty().chart({type:"percent",data:e.list,showAverage:!0,max:100,direct:"v",average:e.average,width:956,height:280,xTitle:"学校",yTitle:"百分比",xFormat:function(e){return e.name}})},n.find("li").bind("click",function(){var n=e(this),s=n.data("source");return n.hasClass("on")?!1:(n.addClass("on").siblings().removeClass("on"),void(i.hasOwnProperty(s)?a(i[s]):t.html('<div class="dy-nothing">报表数据异常</div>')))}).eq(0).click();var l=e("#KeyCalculation"),o=e("#FractionAll"),c=e("#FractionA"),m=e("#FractionAb");u.find("input").bind("change",function(){l.removeAttr("disabled").removeClass("disabled")}),l.bind("click",function(){l.attr("disabled","disabled").addClass("disabled").blur();var e=v[r];e.keyScore=parseFloat(o.val()),e.scoreA=parseFloat(c.val()),e.unScoreA=parseFloat(m.val()),i=d.focusRateAnalysis(r,e),console.log(i),n.find("li").removeClass("on").eq(0).click(),l.removeAttr("disabled").removeClass("disabled")})},s=function(){if(!r)return u.html(""),!1;var e=d.segmentDist(r),a=template("segmentTpl",e);u.html(a)},d.init(o,function(){t()}),l=function(){switch(u.html('<div class="dy-loading"><i></i></div>'),m.html(""),c){case 1:t();break;case 2:n();break;case 3:i();break;case 4:s()}};var h=e(".js-subject"),p=e(".comprehensive"),f=e(".m-subject"),b=e(".js-nav-main");h.on("click","li",function(){var a=e(this),t=~~a.data("subject");return r==t?!1:(a.addClass("on").siblings().removeClass("on"),f.removeClass("hide"),p.removeClass("on"),r=t,void l())}),p.bind("click",function(){return r?(p.addClass("on"),f.addClass("hide"),h.find("li").removeClass("on"),r=0,4==c&&(c=1,b.find("li").eq(0).addClass("on current")),void l()):!1}),b.on("click","li",function(){var a=e(this),t=~~a.data("menu");return c==t?!1:(c=t,a.addClass("on current").siblings().removeClass("on current"),void l())}),u.on("click",".js-students-pop",function(){var a=e(this),t=a.data("uid"),n=d.studentScores(t),i=template("studentScoresTpl",n);e("#SubjectsAll").html(i),e(".pop-result-ranking").popWindow(n.name)}),e("#excel-export").bind("click",function(){d.download()})}(jQuery,SINGER);