!function(t,e){var a,n,r,i,o,s,l={},d=t(".dy-list").data("aid");a=function(t,e){r(t.logins||[],e),i(t.teacher||{}),o(t.student||{}),s(t.loginRank,t.markingRank,t.visitRank)},r=function(a,n){var r=[],i=[];e.each(a,function(t){r.push(e.formatDate(new Date(t.time),"yyyy-MM-dd")),i.push({student:t.student,teacher:t.teacher,y:t.total})});var o=[1,5,16,33][n]||Math.max(Math.floor(r.length/8),1);t("#container-area-draw").highcharts({chart:{type:"area",spacingBottom:30,height:300},title:{text:null},subtitle:{text:null},legend:{layout:"vertical",align:"left",verticalAlign:"top",x:150,y:100,floating:!0,borderWidth:1,backgroundColor:"#FFFFFF"},xAxis:{categories:r,tickInterval:o,showLastLabel:!0,labels:{useHTML:!0,formatter:function(){return this.value}}},yAxis:{stackLabels:{enabled:!0,style:{color:"#656d78","font-weight":"normal"}},gridLineWidth:0,labels:{enabled:!1},title:{text:null}},tooltip:{useHTML:!0,formatter:function(){return e.format('<table class="dy-table page-area-draw"><caption>{0}</caption><tr><td>学生</td><td>教师</td><td>总计</td></tr><tr><td>{1}</td><td>{2}</td><td>{3}</td></tr></table>',this.x,this.point.student,this.point.teacher,this.y)}},plotOptions:{area:{fillOpacity:.5,color:"#647b8d",fillColor:"#f6f7f8"}},credits:{enabled:!1},series:[{name:"登录",showInLegend:!1,data:i}]})},i=function(a){var n=t(".teacher-painting").find(".num"),r=t("#container-chart-left");n.eq(0).html(a.averageLogin),n.eq(1).html(a.averageMarked);var i=[];return a.portraits?(r.show().siblings(".pos-img").show(),r.parents(".wrap-chart").find(".chart-show-not").remove(),e.each(a.portraits,function(t,e){i.push({name:e,y:t})}),i[0].sliced=!0,i[0].selected=!0,void r.highcharts({chart:{backgroundColor:"transparent",plotBackgroundColor:null,plotBorderWidth:0,plotShadow:!1},title:{text:null},credits:{enabled:!1},tooltip:{pointFormat:"{series.name}: <b>{point.y}({point.percentage:.1f} %)</b>"},plotOptions:{pie:{size:160,innerSize:"100",colors:["#2cc49e","#4bcdac","#70d7bd","#93e1ce","#b7ebde","#d5f3ec"],allowPointSelect:!0,cursor:"pointer",dataLabels:{enabled:!0,format:"<b>{point.name}</b>",style:{color:"#666"}}}},series:[{type:"pie",name:"教师印象",data:i}]})):(r.hide().siblings(".pos-img").hide(),r.parents(".wrap-chart").append('<div class="chart-show-not"><img src="'+e.sites["static"]+'/v3/image/ea/chart-showNot1.png" alt=""></div>'),!1)},o=function(a){var n=t(".student-painting").find(".num"),r=t("#container-chart-right");n.eq(0).html(a.averageLogin),n.eq(1).html(a.averageExam),n.eq(2).html(a.averageError);var i=[];return a.portraits?(r.show().siblings(".pos-img").show(),r.parents(".wrap-chart").find(".chart-show-not").remove(),e.each(a.portraits,function(t,e){i.push({name:e,y:t})}),i[0].sliced=!0,i[0].selected=!0,void r.highcharts({chart:{backgroundColor:"transparent",plotBackgroundColor:null,plotBorderWidth:null,plotShadow:!1},title:{text:null},credits:{enabled:!1},tooltip:{pointFormat:"{series.name}: <b>{point.y}({point.percentage:.1f} %)</b>"},plotOptions:{pie:{size:160,innerSize:"100",colors:["#e8525d","#eb6c75","#ef8a91","#f3a7ac","#f7c4c8","#fadcdf"],allowPointSelect:!0,cursor:"pointer",dataLabels:{enabled:!0,format:"<b>{point.name}</b>",style:{color:"#666"}}}},series:[{type:"pie",name:"错因分析",data:i}]})):(r.hide().siblings(".pos-img").hide(),r.parents(".wrap-chart").append('<div class="chart-show-not"><img src="'+e.sites["static"]+'/v3/image/ea/chart-showNot2.png" alt=""></div>'),!1)},s=function(a,n,r){var i,o,s,l=t(".punch-master dd");i=a&&a.length?template("rankTpl",{ranks:a,rankStandard:"登录次数"}):e.showNothing({css:{height:"240px","line-height":"240px"}}),l.eq(0).html(i),o=n&&n.length?template("rankTpl",{ranks:n,rankStandard:"批阅班次"}):e.showNothing({css:{height:"240px","line-height":"240px"}}),l.eq(1).html(o),s=r&&r.length?template("rankTpl",{ranks:r,rankStandard:"主页访问"}):e.showNothing({css:{height:"240px","line-height":"240px"}}),l.eq(2).html(s)},n=function(n,r){var i={id:d,area:n};r&&(i.refresh=!0),t.get("/ea/agency-portrait",i,function(t){l[n]=t,a(t,n),e.pageLoaded()})},t(".ui-tab-nav li").bind("click",function(){var r=t(this),i=r.data("area");return r.hasClass("on")?!1:(r.addClass("on").siblings().removeClass("on"),l.hasOwnProperty(i)?(a(l[i],i),!1):(e.pageLoading(),void n(i)))}),n(0)}(jQuery,SINGER);