!function(t,e){var n=t(".page-course"),o=t(".page-course-main"),i=n.data("batch"),s=!1;e._mix(e,{proportion:function(t,e){var n,o=t.data("total"),i=t.data("current");e&&(i+=e,t.data("current",i),t.siblings(".course-list-bottom").find("em:eq(1)").html(o-i)),n=(0>=o?100:i/o*100).toFixed(2),t.find(".d-process").css({width:n+"%"})},bingData:function(i){e.loading.start(o),n.find(".h2-title").append(i.title),e.each(i.courses,function(t){t.status=t.selected?"sign-up":t.selectedCount==t.capacity?"pack-full":"default"});var s=template("html-course",{data:i.courses});o.html(s),o.find(".course-proportion").each(function(n,o){e.proportion(t(o))})}}),t.get("/elective/courseList",{batch:i},function(t){return t.status?(s=t.data.selectable,void e.bingData(t.data)):(o.append('<div class="dy-nothing"><i class="iconfont dy-icon-none"></i>'+t.message+"</div>"),!1)}),o.on("click",".course-box-list button",function(){var n=t(this).parents(".course-box-list"),o=n.children("h3").text(),i=n.data("id");n.hasClass("sign-up")?e.confirm("你确认要退出“"+o+"”吗？",function(){t.post("/elective/quit",{id:i},function(t){return t.status?void e.msg("退课成功！",2e3,function(){n.toggleClass("sign-up default"),e.proportion(n.find(".course-proportion"),-1)}):(e.alert(t.message),!1)})}):n.hasClass("default")&&(0==t(".page-course-main").find(".sign-up").length?e.confirm("你确认要选择“"+o+"”吗？",function(){t.post("/elective/course",{id:i},function(t){return t.status?void e.msg("选课成功！",2e3,function(){n.toggleClass("sign-up default"),e.proportion(n.find(".course-proportion"),1)}):(e.alert(t.message),!1)})}):e.alert("<p>每人限报一门课<br>您可以先退掉之前的课程再来选择</p>"))})}(jQuery,SINGER);