!function(a,s){var t,n,e,i,o,d,r,l,c,h,p=s.getLogger("marking-mission");s._mix(s,{addLengthClass:function(a){if(a.length<3)return"";var s=["d-sort-3","d-sort-4","d-sort-5"],t=Math.min(a.length-3,s.length-1);return" "+s[t]}}),o={chart:{type:"solidgauge",backgroundColor:"#fff",spacingTop:0,spacingLeft:0,spacingRight:0,spacingBottom:0},title:null,pane:{startAngle:0,endAngle:360,background:{backgroundColor:"#eee",innerRadius:"80%",outerRadius:"100%",borderWidth:0,shape:"arc"}},tooltip:{enabled:!1},yAxis:{min:0,max:100,stops:[[1,"#ed5565"]],lineWidth:0,minorTickInterval:null,tickPixelInterval:400,tickWidth:0,title:null,labels:{y:0,enabled:!1}},plotOptions:{solidgauge:{dataLabels:{y:5,borderWidth:0,useHTML:!0}}}},i=function(t){var n=~~t.data("rank"),e=t.html(),i=a.extend(!0,{},{chart:{events:{click:function(){r(t)}}},credits:{enabled:!1},series:[{name:"班级排名",data:[n],innerRadius:"80%",dataLabels:{format:s.format('<strong class="d-sort{0}">{1}</strong>',s.addLengthClass(e),e),y:12,x:-1,padding:0}}]},o);(0==n||100==n)&&100==n&&(i=a.extend(!0,{},i,{yAxis:{stops:[[1,"#2E94B9"]]}})),t.highcharts(i)},d=function(){t=a(".dm-header").data("joint");for(var s=a(".d-areas .d-mission-item"),n=0;n<s.length;n++)i(s.eq(n).find(".d-rank"),s[n])},r=function(a){if(n&&n.close().remove(),e==a)return e=null,!1;e=a;var t=a.next().html();n=s.dialog({content:t,padding:10,align:"top",width:130,skin:"d-progress-dialog",cancelValue:"关闭",cancelDisplay:!1}),n.show(a.get(0))},l=function(n){p.info(n);var e,i,o;e="/marking/combine/"+t,i=a('<form method="post" class="hide">'),i.attr("action",e),o=a('<input type="text" name="qList" />'),o.val(encodeURIComponent(s.json(n))),i.append(o),a("body").append(i),i.submit()},c=function(){a(".d-mission").bind("click",function(){var s=a(this);if(s.hasClass("disabled"))return!1;a(this).toggleClass("active");var t=a(".d-mission.active"),n=a("#markingBtn");t.length>0?n.undisableFieldset():n.disableField()}).bind("mouseenter",function(){var s=a(this);return s.hasClass("active")||s.hasClass("disabled")?!1:(s.find(".d-word").removeClass("hide"),void s.find(".d-progress").addClass("hide"))}).bind("mouseleave",function(){var s=a(this);return s.hasClass("active")||s.hasClass("disabled")?!1:(s.find(".d-word").addClass("hide"),void s.find(".d-progress").removeClass("hide"))}),a("#markingBtn").bind("click",function(){var t,n,e=a(this),i=[];if(e.blur(),e.hasClass("disabled"))return!1;if(t=a(".d-mission.active"),0==t.length)return s.msg("请选择要批阅的题目！"),!1;for(e.disableField("跳转中..."),n=0;n<t.length;n++){var o=t.eq(n).data("qids").split(",");i.push(o)}l(i)})},h=function(){var n,e,i=a(".top-right-tab"),o=a(".m-object-con"),d=a(".j-contents"),r=a(".j-tab-con"),l=a(".top-right-tab");s.loading.start(o),n=function(){a(".j-object-list").each(function(){var t=a(this);if(t.find("dd").hasClass("nothing"))return!1;if(!t.find("dd").hasClass("no-qua")){var n=t.find(".paper-a").text(),e="";e+='<dd class="nothing">',e+=s.showNothing({word:n+"没有低于50%",icon:"dy-icon-emoji02",css:{width:"940px",height:"80px"}}),e+="</dd>",t.addClass("asdasd"),t.append(e)}});var t;i.on("click","span",function(n){n.stopPropagation();var e=a(this),i=e.data("showtab");return t&&t.cancel(),e.addClass("on").siblings("span").removeClass("on"),"low"==i?(r.addClass("animation"),s.UA.ie?r.removeClass("current"):t=s.later(function(){r.removeClass("current"),t.cancel()},1500,!1),!1):"all"==i?(r.addClass("current").removeClass("animation"),!1):void 0})},e=function(a,t){var n,e,i;s.loading.done(o),d.removeClass("hide"),l.removeClass("hide"),e=function(a){var t,n="",e=a.list.paperAQuestions,i=a.list.paperACount,o=a.list.paperBQuestions,d=a.list.paperBCount;return t=function(a,t,e){var i=function(a){var s,t=["qua","no-qua","qua submi-not"];return s=t[0],a>-1&&50>a&&(s=t[1]),-1==a&&(s=t[2]),s};if(n+='<dl class="m-object-list j-object-list f-cb">',n+="<dt>",n+='<span class="paper-a">'+e+'卷</span>已上传<span class="paper-b">'+t+"</span>份",n+="</dt>",a.length>0)for(var o=0;o<a.length;o++)n+='<dd class="dd '+i(a[o].scoreRate)+'">',n+='<span class="obj-t"><b>'+a[o].sort+"</b><em>"+a[o].rightKey+"</em></span>",n+=-1==a[o].scoreRate?'<span class="obj-b"><em class="font">未提交</em></span>':'<span class="obj-b">'+a[o].scoreRate+"%</span>",n+="</dd>";else n+='<dd class="nothing base-node">',n+=s.showNothing({word:e+"卷没有客观题",css:{width:"940px",height:"80px"}}),n+="</dd>";n+="</dl>"},t(e,i,a.text),2==a.type&&t(o,d,"B"),n},i=a.isAb?{type:2,text:"A",list:a}:{type:1,text:"试",list:a},n=e(i),r.append(n),t&&t.call(this)},a.ajax({type:"GET",url:"/marking/object_ScoreRate",data:{joinBatch:t},dataType:"json",success:function(a){if(a.status)e(a.data,function(){n()});else{var t=s.showNothing({word:a.message,css:{margin:" 0px 20px",height:"80px",width:"1160px"}});o.html(t)}}})},d(),c(),h()}(jQuery,SINGER);