/*! dayeasy.static version:1.1.1 2014-11-06 17:26:44 */
!function(a){function b(b){var c=a('<li id="'+b.id+'"><p class="title">'+b.name+'</p><p class="imgWrap"></p><p class="progress"><span></span></p></li>'),e=a('<div class="file-panel"><span class="cancel">删除</span><span class="rotateRight">向右旋转</span><span class="rotateLeft">向左旋转</span></div>').appendTo(c),f=c.find("p.progress span"),g=c.find("p.imgWrap"),i=function(a){switch(a){case"exceed_size":text="文件大小超出";break;case"interrupt":text="上传暂停";break;default:text="上传失败，请重试"}k.text(text)};"invalid"===b.getStatus()?i(b.statusText):(g.text("预览中"),d.makeThumb(b,function(b,c){if(b)return void g.text("不能预览");var d=a('<img src="'+c+'">');g.empty().append(d)},o,p),b.rotation=0),b.on("statuschange",function(a,d){"progress"===d?f.hide().width(0):"queued"===d&&(c.off("mouseenter mouseleave"),e.remove()),"error"===a||"invalid"===a?(console.log(b.statusText),i(b.statusText)):"interrupt"===a?i("interrupt"):"queued"===a||("progress"===a?f.css("display","block"):"complete"===a&&c.append('<span class="success"></span>')),c.removeClass("state-"+d).addClass("state-"+a)}),c.on("mouseenter",function(){e.stop().animate({height:30})}),c.on("mouseleave",function(){e.stop().animate({height:0})}),e.on("click","span",function(){var c,e=a(this).index();switch(e){case 0:return void d.removeFile(b);case 1:b.rotation+=90;break;case 2:b.rotation-=90}r?(c="rotate("+b.rotation+"deg)",g.css({"-webkit-transform":c,"-mos-transform":c,"-o-transform":c,transform:c})):g.css("filter","progid:DXImageTransform.Microsoft.BasicImage(rotation="+~~(b.rotation/90%4+4)%4+")")}),h.css("display","table"),c.appendTo(h)}function c(b){var c=a("#"+b.id);c.off().find(".file-panel").off().end().remove()}var d,e=a.extend({auto:!0,multiple:!0,fileNum:10,limit:1,fileSite:"http://file.dayez.net",staticSite:"http://static.dayeasy.dev",ext:"image/*",callback:void 0},window.uploaderConfig||{}),f=e.staticSite+"/plugs/webuploader",g=a(".uploadContainer"),h=a("ul.filelist"),i=g.find(".uploadBtn"),j=a("#imgValues"),k=a("#info"),l=0,m=0,n=window.devicePixelRatio||1,o=110*n,p=110*n,q="pedding",r=function(){var a=document.createElement("p").style,b="transition"in a||"WebkitTransition"in a||"MozTransition"in a||"msTransition"in a||"OTransition"in a;return a=null,b}();if(!WebUploader.Uploader.support())throw alert("Web Uploader 不支持您的浏览器！如果你使用的是IE浏览器，请尝试升级 flash 播放器"),new Error("WebUploader does not support the browser you are using.");e.auto&&a(".uploadContainer").find(".uploadBtn").hide(),d=WebUploader.create({auto:e.auto,pick:{id:"#filePicker",multiple:e.multiple},dnd:".uploadContainer ul.filelist",paste:document.body,accept:{title:e.title,extensions:e.ext,mimeTypes:e.mimeTypes},disableGlobalDnd:!0,chunked:!1,chunkSize:104857600,swf:f+"/Uploader.swf",server:e.fileSite+"/uploader?type="+e.type,fileNumLimit:e.fileNum,fileSizeLimit:524288e3,fileSingleSizeLimit:1024*e.limit*1024}),d.onFileQueued=function(a){l++,m+=a.size,b(a)},d.onFileDequeued=function(a){l--,m-=a.size,1>l&&h.css("display","none"),c(a)},d.onUploadProgress=function(b,c){var d=a("#"+b.id),e=d.find(".progress span");e.css("width",100*c+"%")},d.onUploadSuccess=e.callback||function(a,b){if(1==b.state&&b.urls)for(var c=0;c<b.urls.length;c++){var d='<input type="hidden" value="'+b.urls[c]+'" class="upimgURL"/>';j.append(d)}},d.onUploadComplete=function(){setTimeout(function(){k.text("")},3e3)},d.onUploadError=function(){k.text("上传失败，请稍后重试！")},d.on("all",function(a){"startUpload"===a?q="uploading":"stopUpload"===a?q="paused":"uploadFinished"===a&&(q="done"),i.text("uploading"===q?"暂停上传":"开始上传")}),g.delegate(".uploadBtn","click",function(){}),i.on("click",function(){"uploading"===q?d.stop():d.upload()})}(jQuery);