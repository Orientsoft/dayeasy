var teacherController=["$scope","$http",function(e,n){e.info={loading:!0,isnull:!1,key:"",page:1,size:10},e.pages={},e.papers=[],e.load=function(){e.info.loading=!0,e.info.isnull=!1,e.papers=[],e.pages={},n.post("/work/teacher/papers",{index:e.info.page,size:e.info.size,key:e.info.key}).success(function(n){e.info.loading=!1,n.status&&(e.papers=n.data,e.pages=singer.page({current:e.info.page-1,size:e.info.size,total:n.count})),n.status&&0!=n.data.length||(e.info.isnull=!0)}).error(function(){e.info.loading=!1})},$(function(n){e.load()}),e.search=function(){e.info.page=1,e.pages={},e.load()},e.searchPress=function(n){n&&13==n.keyCode&&e.search()},e.page=function(n){1>n||n==e.info.page||(e.info.page=n,e.load())},e.dFormat=function(e,n,i){var o=DateFormat(e);if(16==i){var s=DateFormat(n);o=s+"（未开始） 至 "+o}return o},e.expire=function(e){e.is_edit_expire=singer.isUndefined(e.is_edit_expire)?!0:!e.is_edit_expire},e.saveExpire=function(e){var i=$("#txtEditExpire").val();return i.length<6?void singer.msg("请选择截止时间"):void n.post("/work/teacher/UpdExpire/?batch="+e.batch+"&expire="+i).success(function(n){n.status?(e.show_expire=i,e.is_edit_expire=!1,singer.msg("修改成功！")):singer.msg(n.message)}).error(function(){})},e.cancel=function(e){{var i="撤回后作业将永久消失，已提交的学生作答及已批阅的结果将作废。<br/>是否坚持撤回？";dialog({title:"消息确认提示",backdropBackground:"#000",backdropOpacity:.3,content:i,button:[{value:"取消",callback:function(){},autofocus:!0},{value:"确定",callback:function(){n.post("/work/teacher/cancel",{batch:e.batch}).success(function(e){e.status?(singer.msg("操作成功，页面即将刷新！"),setTimeout(function(){window.location.href=window.location.href},2e3)):singer.msg(e.message)})}}]}).width(420).showModal()}}}],workListController=["$scope","$http",function(e,n){e.info={index:1,loading:!0,isnull:!1,key:"",page:1,size:10},e.pages={},e.papers=[],e.load=function(){e.info.loading=!0,e.info.isnull=!1,e.papers=[],e.pages={},n.post("/work/teacher/papers",{index:e.info.page,size:e.info.size,doing:1==e.info.index,key:e.info.key}).success(function(n){e.info.loading=!1,n.status&&(e.papers=n.data,e.pages=singer.page({current:e.info.page-1,size:e.info.size,total:n.count})),n.status&&0!=n.data.length||(e.info.isnull=!0)}).error(function(){e.info.loading=!1})},$(function(n){singer.isUndefined(singer.uri().done)||(e.info.index=2),e.load()}),e.page=function(n){1>n||n==e.info.page||(e.info.page=n,e.load())},e.search=function(){e.info.page=1,e.pages={},e.load()},e.searchPress=function(n){n&&13==n.keyCode&&e.search()},e.bar=function(n){1>n||n>2||n==e.info.index||(e.info.index=n,e.info.page=1,e.papers=[],e.pages={},e.load())},e.expire=function(n,i){i?singer.confirm("确定关闭当前作业？",function(){e.saveExpire(n,!0)},function(){}):n.is_edit_expire=singer.isUndefined(n.is_edit_expire)?!0:!n.is_edit_expire},e.saveExpire=function(e,i){var o="now";return i||(o=$("#txtEditExpire").val()),"now"!=o&&o.length<6?void singer.msg("请选择截止时间"):void n.post("/work/teacher/UpdExpire/?batch="+e.batch+"&expire="+o).success(function(n){if(n.status){"now"==o&&(o=singer.formatDate(new Date,"yyyy-MM-dd hh:mm")),e.show_expire=o,e.is_edit_expire=!1;var s="关闭成功！作业已移至<span class='tip-color'>已结束</span>咯,请刷新查看！";i||(s="修改成功！作业已移至<span class='tip-color'>进行中</span>咯,请刷新查看！"),singer.msg(s)}else singer.msg(n.message)}).error(function(){singer.msg("修改失败")})},e.cancel=function(e){singer.confirm("确定放弃发布当前作业？",function(){n.post("/work/teacher/cancel",{batch:e.batch}).success(function(e){singer.msg(e.status?"操作成功，请刷新查看！":e.message)})},function(){})},e.dFormat=function(n,i,o){var s=DateFormat(n);if(1==e.info.index){var a=DateFormat(i);s=a+(o?"（未开始） 至 ":" 至 ")+s}return s}}];