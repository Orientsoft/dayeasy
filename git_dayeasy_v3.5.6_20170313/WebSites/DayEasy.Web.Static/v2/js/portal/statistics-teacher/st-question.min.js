var SQ=function(){var t={chinese:["零","一","二","三","四","五","六","七","八","九","十","十一","十二","十三","十四","十五","十六","十七","十八","十九","二十"],def:DEYI.sites["static"]+"/image/default/user_s50x50.jpg",students:[],details:[],data:0,init:function(){t.data&&t.students.length&&singer.loadTemplate("statistics-question",function(){$("#paperTitle").html(t.data.paper_name),$("#className").text(t.data.class_name),"1"==$("#txtIsAb").val()?(t.bind(1),t.bind(2)):t.bind(0),$("#divLoading").hide(),$("#divData").show()})},bind:function(i){var e=singer.render("s-section",{paper_type:i,sections:t.data.sections});$("#divSections").append(e)},student:function(i){if(t.students.length)for(var e=0;e<t.students.length;e++)if(t.students[e].user_id==i)return t.students[e];return 0}};return t}();template.helper("chineseNum",function(t){var i="";return t>-1&&21>t&&(i=SQ.chinese[t]),i}),template.helper("bindStudent",function(t,i){for(var e="",a=0;a<SQ.students.length;a++){var s=SQ.students[a];if(s.user_id==t){var n=s.head_pic&&s.head_pic.length?s.head_pic:SQ.def;e='<li  class="pointer" data-studentid="'+s.user_id+'" onclick="location2Detail(this);" '+(i>9?' style="display: none;"':"")+'><img src="'+n+'" alt="" width="32" height="32" /><span>'+s.real_name+"</span></li>";break}}return e});var location2Detail=function(t){singer.open("/work/marking-detail?batch="+$("#txtBatch").val()+"&paperId="+$("#txtPaperId").val()+"&studentId="+$(t).data("studentid"))};$(function(t){var i=t("#txtBatch").val(),e=t("#txtPaperId").val();if(i&&i.length&&e&&e.length){t.post("statistics-question-data",{batch:i,paper_id:e},function(i){i.status?(SQ.data=i.data,t.post("class-students",{classId:i.data.class_id},function(i){i.status?(t("#divSections").html(""),SQ.students=i.data,SQ.init()):n(i.message)})):n(i.message)}),t(".topic-main").delegate(".link-variable","click",function(){var i=t(this).data("id");singer.open("/variant/push?paper_id="+e+"&question_id="+i+"&app=work")}),t(".topic-main").delegate(".link-detail","click",function(){var a=t(this).data("id");singer.open("detail/"+i+"/"+e+"/"+a)}),t(".topic-main").delegate(".fill-btn","click",function(){var i=t(this).parents(".fill-inthe-blanks");i.find(".td-3 .list-1  li:gt(9)").is(":visible")?(i.find(".td-3 .list-1  li:gt(9)").hide(),t(this).text("更多").removeClass("fill-btnhv")):(i.find(".td-3 .list-1  li").show(),t(this).text("收起").addClass("fill-btnhv"))}),t(".topic-main").delegate(".f-right-expansion","click",function(){var s=t(this).parents(".fill-inthe-blanks");if(s.hasClass("width-hide-show"))return void s.removeClass("width-hide-show");var n=t(this).parents(".q-parent").data("id"),d=t(this).parents(".q-item").data("id");n&&n.length||(n=d,d="");for(var l=0;l<SQ.details.length;l++){var r=SQ.details[l];if(r.qid==n&&r.sid==d)return void s.addClass("width-hide-show")}t.post("statistics-question-detail",{batch:i,paper_id:e,question_id:n,small_question_id:d},function(t){t.status?(SQ.details.push({qid:n,sid:d}),a(t.data,s)):singer.msg(t.message)})});var a=function(t,i){return t?(i.find(".f-tal").text("答案："+t.system_answer),t.answers&&t.answers.length?(t.answers[0].sliced=!0,t.answers[0].selected=!0,i.find(".statistics-lca").highcharts({chart:{plotBackgroundColor:null,plotBorderWidth:null,plotShadow:!1,width:180,height:180},title:null,tooltip:{pointFormat:"{series.name}: <b>{point.y}%</b>"},plotOptions:{pie:{allowPointSelect:!0,cursor:"pointer",dataLabels:{enabled:!1},showInLegend:!1,events:{click:function(t){s(t.point.students,i)}}}},series:[{type:"pie",name:"选项统计",data:t.answers}]}),s(t.answers[0].students,i),void i.addClass("width-hide-show")):void i.addClass("width-hide-show")):void i.addClass("width-hide-show")},s=function(t,i){var e=i.find(".list-2");e.html("");for(var a=0;a<t.length;a++){var s=SQ.student(t[a]);if(s){var n=s.head_pic&&s.head_pic.length?s.head_pic:SQ.def,d='<li class="pointer" data-studentid="'+s.user_id+'" onclick="location2Detail(this);"><img src="'+n+'" alt="" width="32" height="32" /><span>'+s.real_name+"</span></li>";e.append(d)}}},n=function(i){t(".p-err-message").text(i),t(".topic-head").hide(),t("#divLoading").hide(),t("#divData").show()}}});