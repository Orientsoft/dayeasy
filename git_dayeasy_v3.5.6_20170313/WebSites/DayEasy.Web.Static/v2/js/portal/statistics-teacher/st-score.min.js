$(function(t){var a=!1,e=function(){var a=t("#txtBatch").val(),e=t("#txtPaperId").val();t.post("statistics-avges",{batch:a,paper_id:e},function(a){if(!a.status){var e='<div style="padding-top:20px;text-align: center; font-size: 16px;">'+a.message+"</div>";return t(".tab-2").html(e),void t(".tab-3").html(e)}r(a.data)})},r=function(a){var e,r,s=1==t("#txtIsAb").val(),n=a[0].class_id,p=t('<table class="tables tables-canyi-1 tb-score">'),d=t('<table class="tables tables-canyi-1 two-bg">'),h='<tr class="thead"><th width="140">类型/分数/班级</th><th>平均分</th><th>最高分</th><th>最低分</th>'+(s?"<th>A卷平均分</th><th>B卷平均分</th>":"")+"</tr>";if(d.append(h),a[0].score_group&&a[0].score_group.length){a[0].score_group.length>12&&p.attr("style","width:"+140*a[0].score_group.length+"px;");var o=t('<tr class="thead">');o.append('<th width="140">分数段/人数/班级</th>');for(var l=a[0].score_group.length-1;l>=0;l--){var c=a[0].score_group[l];o.append("<th>"+c.ScoreInfo+"</th>")}p.append(o)}if(s){e=t('<table class="tables tables-canyi-1 tb-score hide">'),r=t('<table class="tables tables-canyi-1 tb-score hide">');var i=a[0].ab_score_group;if(i&&2==i.length){if(i[0]&&i[0].length){i[0].length>12&&e.attr("style","width:"+140*i[0].length+"px;");var g=t('<tr class="thead">');g.append('<th width="140">分数段/人数/班级</th>');for(var _=i[0].length-1;_>=0;_--)g.append("<th>"+i[0][_].ScoreInfo+"</th>");e.append(g)}if(i[1]&&i[1].length){i[1].length>12&&r.attr("style","width:"+140*i[1].length+"px;");var b=t('<tr class="thead">');b.append('<th width="140">分数段/人数/班级</th>');for(var v=i[1].length-1;v>=0;v--)b.append("<th>"+i[1][v].ScoreInfo+"</th>");r.append(b)}}}var u=[];a=a.sort(function(t,a){return t.class_name>a.class_name?1:0});for(var f=0;f<a.length;f++){for(var m=a[f],x=!1,w=m.class_name,C=0;C<u.length;C++)u[C]==m.class_id&&(x=!0);x?w=m.class_name+"["+m.time+"]":u.push(m.class_id);var y=t("<tr>");n==m.class_id&&y.addClass("d-active"),y.append("<th>"+w+"</th>"),y.append("<td>"+m.avg+"</td>"),y.append("<td>"+m.max+"</td>"),y.append("<td>"+m.min+"</td>"),s&&m.ab_avg&&(y.append("<td>"+m.ab_avg.AAv+"</td>"),y.append("<td>"+m.ab_avg.BAv+"</td>")),d.append(y);var I=t("<tr>");if(n==m.class_id&&I.addClass("d-active"),I.append("<th>"+w+"</th>"),m.score_group&&m.score_group.length)for(var z=m.score_group.length-1;z>=0;z--)I.append("<td>"+m.score_group[z].Count+"</td>");if(p.append(I),s){var A=t("<tr>");if(A.append("<th>"+w+"</th>"),m.ab_score_group&&2==m.ab_score_group.length&&m.ab_score_group[0]&&m.ab_score_group[0].length)for(var B=m.ab_score_group[0].length-1;B>=0;B--)A.append("<td>"+m.ab_score_group[0][B].Count+"</td>");e.append(A);var S=t("<tr>");if(S.append("<th>"+w+"</th>"),m.ab_score_group&&2==m.ab_score_group.length&&m.ab_score_group[1]&&m.ab_score_group[1].length)for(var q=m.ab_score_group[1].length-1;q>=0;q--)S.append("<td>"+m.ab_score_group[1][q].Count+"</td>");r.append(S)}}var k=t(".tab-2 .hider-y");k.html("").append(p),s&&(k.append(e),k.append(r)),t(".tab-3").html("").append(d)};t(".tac-wrap li").bind("click",function(){if(!t(this).hasClass("z-crt")){t(this).siblings().removeClass("z-crt"),t(this).addClass("z-crt");var r=t(".tab-list");r.hide(),r.eq(t(this).index()).show(),0==t(this).index()||a||(a=!0,e())}}),t("#ddlChangeTab").bind("change",function(){var a=parseInt(t(this).val());t(".tb-score").addClass("hide"),t(".tb-score").eq(a).removeClass("hide")}),t("table").tablesorter({widgets:["zebra","columns"],headers:{0:{sorter:!1},1:{sorter:!1}}})});