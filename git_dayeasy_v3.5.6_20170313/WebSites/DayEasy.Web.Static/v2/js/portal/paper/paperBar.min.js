!function($){$.extend({TestBar:function(a){var t=new paperBar(a);return t.create(!0),t}});var currentDataCache="current_selectData",bar,paperBar=function(options){this.defaults={paperBaseInfo:"",maxNum:100},this.options=$.extend({},this.defaults,options),this.newSelected=[],this.baseInfo=eval("("+this.options.paperBaseInfo+")"),this.initData=this.baseInfo.ChooseQus};paperBar.prototype={create:function(a){bar=this,this.initData&&a&&(window[currentDataCache]=this.initData);var t=barInit(),e=$(t);e.find("#li_cancel").bind("click",this.cancel),e.find("#li_sure").bind("click",this.complete),$("body").append(e)},add:function(a,t){if(this.getCurrentDataCount()+1<=this.options.maxNum){var e=window[currentDataCache];return window[currentDataCache]=addData(e,a,t),this.newSelected.push(a+"_"+t),this.create(),!0}return $.Dayez.msg("题目总数量不能超过 "+this.options.maxNum+" ！"),!1},del:function(a,t){var e=window[currentDataCache];if(e){var n=e[a];n&&$.each(n,function(a,e){e&&e.QId==t&&n.splice(a,1)})}window[currentDataCache]=e,this.create()},getCurrentData:function(){return window[currentDataCache]},getCurrentDataCount:function(){var a=0,t=window[currentDataCache];return t&&$.each(t,function(t,e){e&&(a+=e.length)}),a},cancel:function(){bar.initData&&(window[currentDataCache]=bar.initData),bar.newSelected.length>0&&$.each(bar.newSelected,function(a,t){var e=$.trim(t).split("_");2==e.length&&bar.del(e[0],e[1])}),bar.complete()},complete:function(){var a=bar.baseInfo;a.ChooseQus=window[currentDataCache];var t=bar.baseInfo.CompleteUrl;t||(t="/paper/createpaper/a"),bar.baseInfo.Type||(bar.baseInfo.Type="a");var e=$("<form></form>");e.attr("action",t),e.attr("method","post"),e.attr("target","_self");var n=$('<input type="hidden" name="paperBase" />');return n.attr("value",JSON.stringify(a)),e.append(n),e.appendTo("body"),e.submit(),!1}};var barInit=function(){var a='<div class="right-slide"><div class="r-w-1 trs">',t=[],e=window[currentDataCache];e&&$.each(e,function(a,e){if(e){var n=parseInt(t[a]);isNaN(n)&&(n=0),t[a]=n+e.length}}),a+='<ul class="u-g-1">';var n="";if(t.length>0){var i=0;$.each(t,function(a,e){if(e){var r=convert2QuType(a);8>i?n+='<li><a href="javascript:void(0);" title="'+r+'">'+r+'</a><span class="s-top">'+e+"</span></li>":(8==i&&(n+='<li class="g-more">...<div class="g-posa"><ul class="u-m-1">'),n+='<li><a href="javascript:void(0);">'+r+'</a><span class="s-top">'+e+"</span></li>",a==t.length-1&&(n+='</ul><i class="g-icon2"></i></div></li>')),i++}})}return a+=n,a+="</ul>",a+='<ul class="u-g-2"><li id="li_cancel"><i class="sprite-1 g_icon_9"></i><span class="s-sp-1">取消</span></li><li id="li_sure"><i class="sprite-1 g_icon_10"></i><span class="s-sp-1">完成</span></li></ul>',a+="</div></div>"},addData=function(a,t,e){var n=[];if(a){var i=a[t];i&&($.each(i,function(a,t){t&&t.QId==e&&i.splice(a,1)}),n=i)}else a=[];var r={};return r.QId=e,r.Type=t,r.Score=0,n.push(r),a[t]=n,a},convert2QuType=function(a){var t={1:"单选",2:"多选",3:"不定项",4:"完形",5:"判断",6:"听力",7:"填空",8:"证明",9:"作图",10:"基础知识",11:"现代文阅读",12:"文言文阅读",13:"推断分析",14:"实验探究",15:"默写",16:"解答",17:"排序",18:"阅读理解",19:"连线",20:"计算",21:"作文",22:"综合",23:"翻译",24:"选择"};return t[a]}}(jQuery);