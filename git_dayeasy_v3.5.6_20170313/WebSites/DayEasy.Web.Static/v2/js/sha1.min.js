function hex_sha1(r){return binb2hex(core_sha1(str2binb(r),r.length*chrsz))}function b64_sha1(r){return binb2b64(core_sha1(str2binb(r),r.length*chrsz))}function str_sha1(r){return binb2str(core_sha1(str2binb(r),r.length*chrsz))}function hex_hmac_sha1(r,n){return binb2hex(core_hmac_sha1(r,n))}function b64_hmac_sha1(r,n){return binb2b64(core_hmac_sha1(r,n))}function str_hmac_sha1(r,n){return binb2str(core_hmac_sha1(r,n))}function sha1_vm_test(){return"a9993e364706816aba3e25717850c26c9cd0d89d"==hex_sha1("abc")}function core_sha1(r,n){r[n>>5]|=128<<24-n%32,r[(n+64>>9<<4)+15]=n;for(var a=new Array(80),t=1732584193,e=-271733879,h=-1732584194,c=271733878,s=-1009589776,o=0;o<r.length;o+=16){for(var b=t,_=e,f=h,u=c,i=s,d=0;80>d;d++){a[d]=16>d?r[o+d]:rol(a[d-3]^a[d-8]^a[d-14]^a[d-16],1);var l=safe_add(safe_add(rol(t,5),sha1_ft(d,e,h,c)),safe_add(safe_add(s,a[d]),sha1_kt(d)));s=c,c=h,h=rol(e,30),e=t,t=l}t=safe_add(t,b),e=safe_add(e,_),h=safe_add(h,f),c=safe_add(c,u),s=safe_add(s,i)}return[t,e,h,c,s]}function sha1_ft(r,n,a,t){return 20>r?n&a|~n&t:40>r?n^a^t:60>r?n&a|n&t|a&t:n^a^t}function sha1_kt(r){return 20>r?1518500249:40>r?1859775393:60>r?-1894007588:-899497514}function core_hmac_sha1(r,n){var a=str2binb(r);a.length>16&&(a=core_sha1(a,r.length*chrsz));for(var t=new Array(16),e=new Array(16),h=0;16>h;h++)t[h]=909522486^a[h],e[h]=1549556828^a[h];var c=core_sha1(t.concat(str2binb(n)),512+n.length*chrsz);return core_sha1(e.concat(c),672)}function safe_add(r,n){var a=(65535&r)+(65535&n),t=(r>>16)+(n>>16)+(a>>16);return t<<16|65535&a}function rol(r,n){return r<<n|r>>>32-n}function str2binb(r){for(var n=[],a=(1<<chrsz)-1,t=0;t<r.length*chrsz;t+=chrsz)n[t>>5]|=(r.charCodeAt(t/chrsz)&a)<<24-t%32;return n}function binb2str(r){for(var n="",a=(1<<chrsz)-1,t=0;t<32*r.length;t+=chrsz)n+=String.fromCharCode(r[t>>5]>>>24-t%32&a);return n}function binb2hex(r){for(var n=hexcase?"0123456789ABCDEF":"0123456789abcdef",a="",t=0;t<4*r.length;t++)a+=n.charAt(r[t>>2]>>8*(3-t%4)+4&15)+n.charAt(r[t>>2]>>8*(3-t%4)&15);return a}function binb2b64(r){for(var n="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",a="",t=0;t<4*r.length;t+=3)for(var e=(r[t>>2]>>8*(3-t%4)&255)<<16|(r[t+1>>2]>>8*(3-(t+1)%4)&255)<<8|r[t+2>>2]>>8*(3-(t+2)%4)&255,h=0;4>h;h++)a+=8*t+6*h>32*r.length?b64pad:n.charAt(e>>6*(3-h)&63);return a}var hexcase=0,b64pad="",chrsz=8;